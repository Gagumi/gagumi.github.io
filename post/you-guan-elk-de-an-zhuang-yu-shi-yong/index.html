<html lang="en">
  <head>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title># æœ‰å…³ELKçš„å®‰è£…ä¸ä½¿ç”¨ -
    Gagumi&#39;s blog</title>
<link rel="shortcut icon" href="https://gagumi.github.io/favicon.ico" />
<link
  href="https://fastly.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css"
  rel="stylesheet" />
<link
  rel="stylesheet"
  href="https://fastly.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css" />
<link
  rel="stylesheet"
  href="https://gagumi.github.io/media/css/tailwind.css" />
<link rel="stylesheet" href="https://gagumi.github.io/styles/main.css" />
<link
  rel="alternate"
  type="application/atom+xml"
  title="# æœ‰å…³ELKçš„å®‰è£…ä¸ä½¿ç”¨ -
    Gagumi&#39;s blog - Atom Feed"
  href="https://gagumi.github.io/atom.xml" />



    <meta name="description" content="ELK æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å †æ ˆï¼Œç”±ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ç»„æˆï¼šElasticsearchã€Logstash å’Œ Kibanaã€‚æ¯ä¸ªç»„ä»¶éƒ½å…·æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œå…±åŒæ„å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„æ—¥å¿—ç®¡ç†å’Œåˆ†æå¹³å°ã€‚


  å¯¹ä¸èµ·ï¼Œä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ audio å…ƒç´ ã€‚


å­¦..." />
    <meta
      property="og:title"
      content="# æœ‰å…³ELKçš„å®‰è£…ä¸ä½¿ç”¨ - Gagumi&#39;s blog" />
    <meta property="og:description" content="ELK æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å †æ ˆï¼Œç”±ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ç»„æˆï¼šElasticsearchã€Logstash å’Œ Kibanaã€‚æ¯ä¸ªç»„ä»¶éƒ½å…·æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œå…±åŒæ„å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„æ—¥å¿—ç®¡ç†å’Œåˆ†æå¹³å°ã€‚


  å¯¹ä¸èµ·ï¼Œä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ audio å…ƒç´ ã€‚


å­¦..." />
    <meta property="og:type" content="articles" />
    <meta property="og:url" content="https://gagumi.github.io/post/you-guan-elk-de-an-zhuang-yu-shi-yong/" />
    <meta
      property="og:image"
      content="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516224707.png" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:width" content="1200" />
    <meta
      name="twitter:title"
      content="# æœ‰å…³ELKçš„å®‰è£…ä¸ä½¿ç”¨ - Gagumi&#39;s blog" />
    <meta name="twitter:description" content="ELK æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å †æ ˆï¼Œç”±ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ç»„æˆï¼šElasticsearchã€Logstash å’Œ Kibanaã€‚æ¯ä¸ªç»„ä»¶éƒ½å…·æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œå…±åŒæ„å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„æ—¥å¿—ç®¡ç†å’Œåˆ†æå¹³å°ã€‚


  å¯¹ä¸èµ·ï¼Œä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ audio å…ƒç´ ã€‚


å­¦..." />
    <meta name="twitter:card" content="summary_large_image" />
    <link rel="canonical" href="https://gagumi.github.io/post/you-guan-elk-de-an-zhuang-yu-shi-yong/" />

    <link
      rel="stylesheet"
      href="https://fastly.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css" />
    <link
      rel="stylesheet"
      href="https://fastly.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css" />

    
    <link
      rel="stylesheet"
      href="https://gagumi.github.io/media/css/prism-synthwave84.css" />
     
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" />
    
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/Xalaok/Fonts@main/LXGWWenKaiLite/regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/Xalaok/Fonts@main/LXGWWenKaiLite/bold.woff2" as="font" type="font/woff2" crossorigin>
  </head>

  <body>
    <div class="antialiased flex flex-col min-h-screen" id="app">
      <a
        href="https://gagumi.github.io"
        class="fixed top-0 left-0 mt-4 bg-black text-white dark:text-gray-700 dark:bg-yellow-50 dark:hover:bg-black dark:hover:text-white inline-flex p-2 pl-8 hover:text-gray-700 hover:bg-yellow-50 font-bold z-10 transition-fast animated fadeInLeft">
        Gagumi&#39;s blog
      </a>
      <div class="max-w-4xl w-full mx-auto">
        <div
          class="shadow-box bg-white dark:bg-gray-600 rounded-lg pt-32 md:pt-64 px-4 md:px-8 pb-8 animated fadeIn mb-8">
          <h1
            class="text-5xl font-semibold leading-normal pb-8 mb-8 border-b-8 border-gray-700">
            # æœ‰å…³ELKçš„å®‰è£…ä¸ä½¿ç”¨
          </h1>
          
          <img
            src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516224707.png"
            alt="# æœ‰å…³ELKçš„å®‰è£…ä¸ä½¿ç”¨"
            class="block w-full mb-8" />
          
          <div class="mb-8 flex flex-wrap">
            <div class="text-gray-400 text-sm mr-4">
              2023-05-14 Â· 8 min read
            </div>
            
            <a
              href="https://gagumi.github.io/tag/69Q4bli3R/"
              class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              Elasticsearch
            </a>
            
            <a
              href="https://gagumi.github.io/tag/8jwhoDaNh/"
              class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              Logstash
            </a>
            
            <a
              href="https://gagumi.github.io/tag/MnRlqQX3-/"
              class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              Kibana
            </a>
            
            <a
              href="https://gagumi.github.io/tag/oFLQRYHIn/"
              class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              python
            </a>
            
            <a
              href="https://gagumi.github.io/tag/-iTzgZm-A/"
              class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              åšå®¢
            </a>
            
          </div>
          <div class="markdown mb-8" v-pre><p style="font-size:20px;">ELK æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶å †æ ˆï¼Œç”±ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ç»„æˆï¼šElasticsearchã€Logstash å’Œ Kibanaã€‚æ¯ä¸ªç»„ä»¶éƒ½å…·æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œå…±åŒæ„å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„æ—¥å¿—ç®¡ç†å’Œåˆ†æå¹³å°ã€‚
</p>
<audio controls src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/audio/HOYO-MiX%20_%20Anthony%20Lynch%20-%20%E8%B8%8F%E4%B8%8A%E6%97%85%E9%80%94%20Take%20the%20Journey.flac" type="audio/flac" volume="0.3" loop>
  å¯¹ä¸èµ·ï¼Œä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ audio å…ƒç´ ã€‚
</audio>
<!-- more -->
<p>å­¦æ ¡æä¾›äº†å››ä¸ªæœˆçš„ä½¿ç”¨èµ„æ ¼ï¼Œä½†æ˜¯æ˜¾ç¤ºåªæ˜¾ç¤º14å¤©ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ¯ä¸ªç»„ä»¶çš„ç®€è¦ä»‹ç»ï¼š</p>
<p>Elasticsearchï¼šElasticsearch æ˜¯ä¸€ä¸ªå®æ—¶åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œç”¨äºå­˜å‚¨ã€æœç´¢å’Œåˆ†æå¤§è§„æ¨¡æ•°æ®ã€‚å®ƒè¢«è®¾è®¡ç”¨äºé«˜å¯æ‰©å±•æ€§å’Œå®¹é”™æ€§ï¼Œå¯ä»¥å¤„ç†æµ·é‡æ•°æ®ï¼Œå¹¶æä¾›å¼ºå¤§çš„å…¨æ–‡æœç´¢ã€å¤æ‚æŸ¥è¯¢ã€èšåˆå’Œåˆ†æèƒ½åŠ›ã€‚</p>
<p>Logstashï¼šLogstash æ˜¯ä¸€ä¸ªç”¨äºæ•°æ®æ”¶é›†ã€å¤„ç†å’Œä¼ è¾“çš„å¼€æºå·¥å…·ã€‚å®ƒå¯ä»¥ä»å„ç§æ¥æºï¼ˆå¦‚æ—¥å¿—æ–‡ä»¶ã€æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰æ”¶é›†æ•°æ®ï¼Œå¹¶å°†å…¶è¿›è¡Œè½¬æ¢ã€æ ‡å‡†åŒ–å’Œè¿‡æ»¤ï¼Œç„¶åå‘é€åˆ°ä¸åŒçš„ç›®æ ‡ï¼Œå…¶ä¸­åŒ…æ‹¬ Elasticsearchã€‚</p>
<p>Kibanaï¼šKibana æ˜¯ä¸€ä¸ªç”¨äºæ•°æ®å¯è§†åŒ–å’Œåˆ†æçš„å¼€æºå·¥å…·ã€‚å®ƒæä¾›äº†ç›´è§‚çš„ç”¨æˆ·ç•Œé¢ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡äº¤äº’å¼å›¾è¡¨ã€ä»ªè¡¨ç›˜ã€åœ°å›¾ç­‰æ–¹å¼æ¥æ¢ç´¢å’Œå¯è§†åŒ– Elasticsearch ä¸­çš„æ•°æ®ã€‚Kibana æä¾›äº†ä¸°å¯Œçš„å¯è§†åŒ–åŠŸèƒ½ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿä»¥ç›´è§‚çš„æ–¹å¼ç†è§£å’Œåˆ†ææ•°æ®ã€‚</p>
<p>è¿™ä¸‰ä¸ªç»„ä»¶å…±åŒåä½œï¼Œæ„å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„æ—¥å¿—ç®¡ç†å’Œåˆ†æå¹³å°ã€‚Logstash ç”¨äºæ”¶é›†å’Œå¤„ç†æ•°æ®ï¼ŒElasticsearch ç”¨äºå­˜å‚¨å’Œç´¢å¼•æ•°æ®ï¼Œè€Œ Kibana åˆ™æä¾›äº†äº¤äº’å¼çš„æ•°æ®å¯è§†åŒ–å’Œåˆ†æç•Œé¢ã€‚</p>
<p>ELK è¢«å¹¿æ³›åº”ç”¨äºæ—¥å¿—ç®¡ç†ã€å®æ—¶ç›‘æ§ã€æ•°æ®åˆ†æå’Œä¸šåŠ¡æ™ºèƒ½ç­‰é¢†åŸŸã€‚å®ƒèƒ½å¤Ÿå¤„ç†å’Œåˆ†æå„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ—¥å¿—æ•°æ®ã€æŒ‡æ ‡æ•°æ®ã€æ–‡æœ¬æ•°æ®ç­‰ï¼Œå¸®åŠ©ç”¨æˆ·å‘ç°æ½œåœ¨çš„é—®é¢˜ã€è·å¾—å®æ—¶è§è§£ï¼Œå¹¶æ”¯æŒæ•°æ®é©±åŠ¨çš„å†³ç­–å’Œè¿è¥ä¼˜åŒ–ã€‚</p>
<p>é™¤äº†æ ¸å¿ƒç»„ä»¶ä¹‹å¤–ï¼ŒELK ç”Ÿæ€ç³»ç»Ÿè¿˜åŒ…æ‹¬å…¶ä»–å·¥å…·å’Œæ’ä»¶ï¼Œç”¨äºæ‰©å±•å’Œå¢å¼ºåŠŸèƒ½ã€‚ä¾‹å¦‚ï¼ŒBeats ç”¨äºè½»é‡çº§æ•°æ®æ”¶é›†ï¼ŒElastic APM ç”¨äºåº”ç”¨æ€§èƒ½ç›‘æ§ï¼ŒElasticsearch SQL ç”¨äºæ‰§è¡Œ SQL æŸ¥è¯¢ç­‰ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼ŒELK æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å¹³å°ï¼Œç”¨äºé›†ä¸­å­˜å‚¨ã€æœç´¢ã€åˆ†æå’Œå¯è§†åŒ–å„ç§ç±»å‹çš„æ•°æ®ã€‚å®ƒçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ä½¿å…¶æˆä¸ºå¤„ç†å¤§è§„æ¨¡æ•°æ®å’Œè§£å†³å®æ—¶åˆ†ææŒ‘æˆ˜çš„ç†æƒ³é€‰æ‹©ã€‚</p>
<h3 id="ç™»å½•ä¿¡æ¯">ç™»å½•ä¿¡æ¯</h3>
<p>åœ¨å¯åŠ¨ä¸€ä¸ªé¡¹ç›®ï¼ˆtest-lessonï¼‰ä¹‹åï¼Œèƒ½è·å¾—è´¦å·å¯†ç </p>
<p>username,password<br>
elastic,gUhQRAqAalsPgBFXVxzGwkCV</p>
<h3 id="home-page">Home page</h3>
<p><a href="https://test-lesson-93537f.kb.us-central1.gcp.cloud.es.io:9243/app/integrations/browse">Browse integrations - Integrations - Elastic (es.io)</a></p>
<p>ç«¯å£æ˜¯9243</p>
<p>https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243</p>
<h3 id="æ³¨å†Œ-with-ubuntu">æ³¨å†Œ with ubuntu</h3>
<pre><code class="language-ubuntu">curl --version
</code></pre>
<pre><code class="language-ubuntu">curl -X GET -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/_cat/indices?v'
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516171051.png" alt="" loading="lazy"></figure>
<h3 id="åˆ›å»ºä¸€ä¸ªindex">åˆ›å»ºä¸€ä¸ªindex</h3>
<pre><code>curl -X PUT 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/customer?pretty'
</code></pre>
<p>ä¸ä¼šæˆåŠŸï¼Œéœ€è¦æ·»åŠ èº«ä»½éªŒè¯ï¼ˆæ€»æ˜¯éœ€è¦å—ï¼Ÿï¼‰</p>
<pre><code class="language-ubuntu">curl -X PUT -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/customer?pretty'
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516171857.png" alt="" loading="lazy"></figure>
<pre><code class="language-ubuntu">curl -X GET -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/_cat/indices?v'
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516172240.png" alt="" loading="lazy"></figure>
<p>å¯ä»¥çœ‹åˆ°å·²ç»å¤šäº†ä¸€ä¸ªcustomer</p>
<pre><code>curl -X PUT -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/customer/_doc/1?pretty' -H 'Content-Type:application/json' -d '{\&quot;firstname\&quot;:\&quot;John\&quot;, \&quot;lastname\&quot;:\&quot;Doe\&quot;, \&quot;age\&quot;:22}' 
</code></pre>
<p>ğŸ¤¡ï¼Œä¸éœ€è¦è½¬ä¹‰å­—ç¬¦æ</p>
<pre><code class="language-ubuntu">curl -X PUT -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/customer/_doc/1?pretty' -H 'Content-Type:application/json' -d '{&quot;firstname&quot;:&quot;John&quot;, &quot;lastname&quot;:&quot;Doe&quot;, &quot;age&quot;:22}'
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516173535.png" alt="" loading="lazy"></figure>
<pre><code class="language-ubuntu">curl -X PUT -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/customer/_doc/2?pretty' -H 'Content-Type:application/json' -d '{&quot;firstname&quot;:&quot;Anna&quot;, &quot;lastname&quot;:&quot;Conda&quot;, &quot;age&quot;:37}'
</code></pre>
<pre><code class="language-ubuntu">curl -X PUT -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/customer/_doc/3?pretty' -H 'Content-Type:application/json' -d '{&quot;firstname&quot;:&quot;Bob&quot;, &quot;lastname&quot;:&quot;Dylan&quot;, &quot;age&quot;:37}'
</code></pre>
<p>æ¥ä¸‹æ¥ä½¿ç”¨queryè¯­å¥å°æ£€æŸ¥ä¸€æ‰‹</p>
<pre><code class="language-ubuntu">curl -X GET -u elastic:gUhQRAqAalsPgBFXVxzGwkCV 'https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243/customer/_doc/1?pretty'
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516174431.png" alt="" loading="lazy"></figure>
<p>æˆ–è€…ä½¿ç”¨äº‘ä¸Šï¼ˆæˆ–æ˜¯æœ¬åœ°çš„ï¼‰webç•Œé¢çš„Dev  Tools å‘é€å‘½ä»¤ï¼š</p>
<figure data-type="image" tabindex="6"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516174913.png" alt="" loading="lazy"></figure>
<h3 id="å¯è§†åŒ–-in-kibana">å¯è§†åŒ– in kibana</h3>
<figure data-type="image" tabindex="7"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516180803.png" alt="" loading="lazy"></figure>
<p>åˆ›å»ºä¸€ä¸ªåä¸ºâ€œcustomerâ€çš„index patternï¼Œåœ¨åˆ›å»ºè¾“å…¥åå­—çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åŒ¹é…å·²æœ‰çš„èµ„æºã€‚</p>
<p>å®ç°å››ä¸ªfiler(DSL query)</p>
<ul>
<li>
<p>firstname : Anna</p>
<pre><code class="language-sql">{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;firstname&quot;: &quot;Anna&quot;
    }
  }
}
</code></pre>
<figure data-type="image" tabindex="8"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516183355.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>firstname : *n(æ‰¾åˆ°ä»»ä½•ä»¥nç»“å°¾çš„)</p>
<pre><code class="language-sql">{
  &quot;wildcard&quot;: {
    &quot;firstname&quot;: &quot;*n&quot;
  }
}
</code></pre>
<figure data-type="image" tabindex="9"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516183507.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>firstname : *n*</p>
<pre><code class="language-sql">{
  &quot;wildcard&quot;: {
    &quot;firstname&quot;: &quot;*n*&quot;
  }
}
</code></pre>
<figure data-type="image" tabindex="10"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/image-20230516183852518.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>age &gt; 23</p>
</li>
</ul>
<pre><code class="language-sql">{
  &quot;query&quot;: {
    &quot;range&quot;: {
      &quot;age&quot;: {
        &quot;gt&quot;: 23
      }
    }
  }
}
</code></pre>
<figure data-type="image" tabindex="11"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516184127.png" alt="" loading="lazy"></figure>
<p>é™¤äº† <code>gt</code>ï¼ŒElasticsearch çš„ range æŸ¥è¯¢è¿˜æ”¯æŒä»¥ä¸‹æ“ä½œç¬¦ï¼š</p>
<ul>
<li><code>lt</code>ï¼šå°äºï¼ˆless thanï¼‰</li>
<li><code>gte</code>ï¼šå¤§äºæˆ–ç­‰äºï¼ˆgreater than or equal toï¼‰</li>
<li><code>lte</code>ï¼šå°äºæˆ–ç­‰äºï¼ˆless than or equal toï¼‰</li>
</ul>
<h3 id="æŸ±çŠ¶å›¾å¯è§†åŒ–ageå’Œcount">æŸ±çŠ¶å›¾å¯è§†åŒ–ï¼ˆageå’Œcountï¼‰</h3>
<figure data-type="image" tabindex="12"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516210732.png" alt="" loading="lazy"></figure>
<p>save as â€œcustomer per ageâ€ å¹¶åœ¨dashboardä¸Šå±•ç¤ºã€‚</p>
<figure data-type="image" tabindex="13"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516211109.png" alt="" loading="lazy"></figure>
<h3 id="python-elastic">Python &amp; Elastic</h3>
<p>ä½¿ç”¨pipå®‰è£…ï¼š</p>
<pre><code class="language-cmd">pip install elasticsearch
</code></pre>
<p>ä»¥kaggleæ•°æ®é›†ä¸ºä¾‹å­è¿›è¡Œè¯•éªŒï¼šï¼ˆhttps://www.kaggle.com/datasets/datasnaek/chessï¼‰</p>
<pre><code class="language-python">from datetime import datetime
import os
from elasticsearch import Elasticsearch,helpers

password = os.environ[&quot;ENV_PASSWORD&quot;]
client = Elasticsearch(hosts=[&quot;https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243&quot;],basic_auth=('elastic',password))  
docs = []
docs.append({&quot;name&quot;:&quot;Bob&quot;,&quot;timestamp&quot;:datetime.utcnow().isoformat()})

helpers.bulk(client,docs,index=&quot;index_fo_python_test&quot;)
</code></pre>
<p>ä¸€å¼€å§‹ç›´æ¥ç»™<code>os.environ[&quot;ENV_PASSWORD&quot;]</code>é‡Œè¾“å…¥äº†æˆ‘çš„å¯†ç ï¼Œä½†è¿™æ˜¯ä¸æ­£ç¡®çš„ï¼Œä¼šæŠ¥é”™key errorï¼Œ<code>password = os.environ[]</code> è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯ä»ç¯å¢ƒå˜é‡ä¸­è·å–ä¸€ä¸ªå€¼ï¼Œå¹¶å°†å…¶èµ‹ç»™å˜é‡ <code>password</code>ã€‚</p>
<p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œç¯å¢ƒå˜é‡æ˜¯ä¸€äº›å…¨å±€çš„å€¼ï¼Œç”¨äºå­˜å‚¨é…ç½®ä¿¡æ¯ã€è®¤è¯å‡­æ®ã€è·¯å¾„ç­‰ã€‚é€šè¿‡ä½¿ç”¨ <code>os.environ</code>ï¼Œä½ å¯ä»¥åœ¨ Python è„šæœ¬ä¸­è®¿é—®è¿™äº›ç¯å¢ƒå˜é‡ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œ<code>os.environ</code> æ˜¯ä¸€ä¸ªå­—å…¸å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†å½“å‰ç³»ç»Ÿç¯å¢ƒä¸­æ‰€æœ‰å·²å®šä¹‰çš„ç¯å¢ƒå˜é‡ã€‚ä½ å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ã€API å¯†é’¥ç­‰ï¼‰ï¼Œè€Œä¸éœ€è¦ç›´æ¥åœ¨ä»£ç ä¸­ç¡¬ç¼–ç è¿™äº›æ•æ„Ÿä¿¡æ¯ã€‚</p>
<p>æ‰€ä»¥éœ€è¦åœ¨ç¯å¢ƒä¸­è®¾ç½®å…¶å€¼ï¼š</p>
<pre><code class="language-cmd">set ENV_PASSWORD=gUhQRAqAalsPgBFXVxzGwkCV
</code></pre>
<p>å†æ¬¡è¿è¡Œpythonæ–‡ä»¶ï¼Œé€šè¿‡ï¼Œæ¥ä¸‹æ¥å»è¿›è¡Œå¯è§†åŒ–</p>
<p>å»å¾€Stack Managementé¡µé¢ï¼ŒæŸ¥çœ‹å¹¶åˆ›å»ºä¸€ä¸ªdata viewsï¼Œä¸¥æ ¼æŒ‰ç…§pythonä»£ç é‡Œé¢çš„ä¿¡æ¯åˆ›å»ºï¼š</p>
<figure data-type="image" tabindex="14"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516214519.png" alt="" loading="lazy"></figure>
<p>å›åˆ°discoverï¼Œå¹¶é€‰æ‹©index_fo_python_test</p>
<figure data-type="image" tabindex="15"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516214844.png" alt="" loading="lazy"></figure>
<h3 id="ä½¿ç”¨pythonè¿›è¡Œå®æ—¶å‘é€">ä½¿ç”¨pythonè¿›è¡Œå®æ—¶å‘é€</h3>
<p>æˆ‘ä½¿ç”¨äº†ä»¥ä¸‹çš„ä»£ç è¿›è¡Œå®æ—¶å‘é€ï¼š</p>
<pre><code class="language-python">import datetime
import random
import time
import os
from elasticsearch import Elasticsearch, helpers

# è¿æ¥ Elasticsearch
password = os.environ[&quot;ENV_PASSWORD&quot;]
es = Elasticsearch(hosts=[&quot;https://test-lesson-93537f.es.us-central1.gcp.cloud.es.io:9243&quot;],basic_auth=('elastic',password))  
# å®šä¹‰å‘é€æ•°æ®çš„å‡½æ•°
def send_data():
    # ç”Ÿæˆéšæœºæ•°æ®
    data = {
        &quot;timestamp&quot;: datetime.datetime.utcnow(),
        &quot;value&quot;: random.randint(1, 100)
    }

    # æ„å»ºç´¢å¼•æ“ä½œ
    action = {
        &quot;_index&quot;: &quot;index_for_realtime_by_python&quot;,
        &quot;_source&quot;: data
    }

    # æ‰¹é‡ç´¢å¼•æ•°æ®
    helpers.bulk(es, [action])

# å‘é€æ•°æ®å¹¶è§‚å¯Ÿä»ªè¡¨ç›˜å˜åŒ–
while True:
    # å‘é€æ•°æ®åˆ° Elasticsearch
    send_data()

    # æš‚åœ5ç§’
    time.sleep(5)

</code></pre>
<p>åœ¨å¹³å°ä¸Šè¿›è¡Œå¯è§†åŒ–è®¾ç½®ï¼ˆåˆ«å¿˜äº†æ–°å»ºä¸€ä¸ªdataviewï¼ŒåŒä¸Šï¼‰</p>
<figure data-type="image" tabindex="16"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516221022.png" alt="" loading="lazy"></figure>
<p>åœ¨dashboardä¸Šçœ‹èµ·æ¥è¿™ä¸ªå›¾åƒæ˜¯æ­»çš„ï¼Œä½ éœ€è¦æ‰‹åŠ¨åˆ·æ–°ã€‚è¿™æ—¶å»åˆ°discoveré¡µé¢ï¼šå³ä¸Šè§’è®¾ç½®refresh every 1sï¼ˆæˆ–æ˜¯æ›´çŸ­ï¼‰ï¼Œæ­¤æ—¶å›¾è¡¨å°±å®æ—¶åŠ¨èµ·æ¥åŠ›ï¼</p>
<figure data-type="image" tabindex="17"><img src="https://raw.githubusercontent.com/Gagumi/MyPicGo/main/img/20230516222304.png" alt="" loading="lazy"></figure>
</div>
          <!-- Share to Twitter, Weibo, Telegram -->
          <div class="flex items-center">
            <div class="mr-4 flex items-center">
              <i class="ri-share-forward-line text-gray-500"></i>
            </div>
            <div
              class="px-4 cursor-pointer text-blue-500 hover:bg-blue-100 dark:hover:bg-gray-600 inline-flex"
              @click="shareToTwitter">
              <i class="ri-twitter-line"></i>
            </div>
            <div
              class="px-4 cursor-pointer text-red-500 hover:bg-red-100 dark:hover:bg-gray-600 inline-flex"
              @click="shareToWeibo">
              <i class="ri-weibo-line"></i>
            </div>
            <div
              class="px-4 cursor-pointer text-indigo-500 hover:bg-indigo-100 dark:hover:bg-gray-600 inline-flex"
              @click="shareToTelegram">
              <i class="ri-telegram-line"></i>
            </div>
          </div>
        </div>

         
        <div id="vlaine-comment"></div>
         <footer class="py-12 text-center px-4 md:px-0" v-pre>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
</footer>

      </div>

      <!-- TOC Container -->
      <div
        class="fixed right-0 bottom-0 mb-16 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white dark:bg-gray-500 dark:text-gray-200 hover:shadow-lg transition-all animated fadeInRight"
        @click="showToc = true">
        <i class="ri-file-list-line"></i>
      </div>

      <div
        class="fixed right-0 top-0 bottom-0 overflow-y-auto w-64 bg-white dark:bg-gray-800 p-4 border-l border-gray-100 dark:border-gray-600 z-10 transition-fast"
        :class="{ '-mr-64': !showToc }">
        <div class="flex mb-4 justify-end">
          <div
            class="w-8 h-8 inline-flex justify-center items-center rounded-full cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-fast"
            @click="showToc = false">
            <i class="ri-close-line text-lg"></i>
          </div>
        </div>
        <div class="post-toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E7%99%BB%E5%BD%95%E4%BF%A1%E6%81%AF">ç™»å½•ä¿¡æ¯</a></li>
<li><a href="#home-page">Home page</a></li>
<li><a href="#%E6%B3%A8%E5%86%8C-with-ubuntu">æ³¨å†Œ with ubuntu</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAindex">åˆ›å»ºä¸€ä¸ªindex</a></li>
<li><a href="#%E5%8F%AF%E8%A7%86%E5%8C%96-in-kibana">å¯è§†åŒ– in kibana</a></li>
<li><a href="#%E6%9F%B1%E7%8A%B6%E5%9B%BE%E5%8F%AF%E8%A7%86%E5%8C%96age%E5%92%8Ccount">æŸ±çŠ¶å›¾å¯è§†åŒ–ï¼ˆageå’Œcountï¼‰</a></li>
<li><a href="#python-elastic">Python &amp; Elastic</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8python%E8%BF%9B%E8%A1%8C%E5%AE%9E%E6%97%B6%E5%8F%91%E9%80%81">ä½¿ç”¨pythonè¿›è¡Œå®æ—¶å‘é€</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
      </div>

      <!-- Back to top -->
      <div
        class="fixed right-0 bottom-0 mb-4 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white hover:shadow-lg transition-all dark:bg-gray-500 dark:text-gray-200"
        @click="backToUp"
        v-show="scrolled">
        <i class="ri-arrow-up-line"></i>
      </div>
    </div>

    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
  <!-- Background of PhotoSwipe.
        It's a separate element as animating opacity is faster than rgba(). -->
  <div class="pswp__bg"></div>
  <!-- Slides wrapper with overflow:hidden. -->
  <div class="pswp__scroll-wrap">
    <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
    <div class="pswp__ui pswp__ui--hidden">
      <div class="pswp__top-bar">
        <!--  Controls are self-explanatory. Order can be changed. -->
        <div class="pswp__counter"></div>
        <button
          class="pswp__button pswp__button--close"
          title="Close (Esc)"></button>
        <button
          class="pswp__button pswp__button--fs"
          title="Toggle fullscreen"></button>
        <button
          class="pswp__button pswp__button--zoom"
          title="Zoom in/out"></button>
        <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
        <!-- element will get class pswp__preloader--active when preloader is running -->
        <div class="pswp__preloader">
          <div class="pswp__preloader__icn">
            <div class="pswp__preloader__cut">
              <div class="pswp__preloader__donut"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
        <div class="pswp__share-tooltip"></div>
      </div>
      <button
        class="pswp__button pswp__button--arrow--left"
        title="Previous (arrow left)"></button>
      <button
        class="pswp__button pswp__button--arrow--right"
        title="Next (arrow right)"></button>
      <div class="pswp__caption">
        <div class="pswp__caption__center"></div>
      </div>
    </div>
  </div>
</div>


    <script src="https://fastly.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://gagumi.github.io/media/scripts/main.js"></script>

    <!-- Code Highlight -->
    
    <script src="https://gagumi.github.io/media/prism.js"></script>
    <script>
      Prism.highlightAll()
    </script>
    

    <script src="https://fastly.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>
    <script>
      //æ‹¿åˆ°é¢„è§ˆæ¡†æ¶ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„htmlä»£ç 
      var pswpElement = document.querySelectorAll('.pswp')[0]
      //å®šä¹‰å›¾ç‰‡æ•°ç»„å˜é‡
      var imgitems
      /**
       * ç”¨äºæ˜¾ç¤ºé¢„è§ˆç•Œé¢
       * @param index å›¾ç‰‡æ•°ç»„ä¸‹æ ‡
       */
      function viewImg(index) {
        //å…¶å®ƒé€‰é¡¹è¿™é‡Œä¸åšè¿‡å¤šé˜è¿°ï¼Œè¯¦æƒ…è§å®˜ç½‘
        var pswpoptions = {
          index: parseInt(index, 10), // å¼€å§‹å¹»ç¯ç‰‡ç´¢å¼•ã€‚0æ˜¯ç¬¬ä¸€å¼ å¹»ç¯ç‰‡ã€‚å¿…é¡»æ˜¯æ•´æ•°ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚
          bgOpacity: 0.7, // èƒŒæ™¯é€æ˜åº¦ï¼Œ0-1
          maxSpreadZoom: 3, // ç¼©æ”¾çº§åˆ«ï¼Œä¸è¦å¤ªå¤§
        }
        //åˆå§‹åŒ–å¹¶æ‰“å¼€PhotoSwipeï¼ŒpswpElementå¯¹åº”ä¸Šé¢é¢„è§ˆæ¡†æ¶ï¼ŒPhotoSwipeUI_Defaultä¸ºçš®è‚¤ï¼Œimgitemsä¸ºå›¾ç‰‡æ•°ç»„ï¼Œpswpoptionsä¸ºé€‰é¡¹
        var gallery = new PhotoSwipe(
          pswpElement,
          PhotoSwipeUI_Default,
          imgitems,
          pswpoptions
        )
        gallery.init()
      }
      /**
       * ç”¨äºæ·»åŠ å›¾ç‰‡ç‚¹å‡»äº‹ä»¶
       * @param img å›¾ç‰‡å…ƒç´ 
       * @param index æ‰€å±ä¸‹æ ‡ï¼ˆåœ¨imgitemsä¸­çš„ä½ç½®ï¼‰
       */
      function addImgClick(img, index) {
        img.onclick = function () {
          viewImg(index)
        }
      }
      /**
       * è½®è¯¢æ‰€æœ‰å›¾ç‰‡ï¼Œè·å–srcã€widthã€heightç­‰æ•°æ®ï¼ŒåŠ å…¥imgitemsï¼Œå¹¶ç»™å›¾ç‰‡å…ƒç´ æ·»åŠ äº‹ä»¶
       * æœ€å¥½åœ¨onloadä¸­æ‰§è¡Œè¯¥æ–¹æ³•ï¼Œæœ¬ç«™å› æ”¾åœ¨æœ€åº•éƒ¨ï¼Œæ‰€ä»¥ç›´æ¥åˆå§‹åŒ–
       * å¼‚æ­¥åŠ è½½å›¾ç‰‡å¯åœ¨å›¾ç‰‡å…ƒç´ åˆ›å»ºå®Œæˆåè°ƒç”¨æ­¤æ–¹æ³•
       */
      function initImg() {
        //é‡ç½®å›¾ç‰‡æ•°ç»„
        imgitems = []
        //æŸ¥æ‰¾class:markdown ä¸‹çš„æ‰€æœ‰imgå…ƒç´ å¹¶éå†
        var imgs = document.querySelectorAll('.markdown img')
        for (var i = 0; i < imgs.length; i++) {
          var img = imgs[i]
          //æœ¬ç«™ç›¸å†Œåˆå§‹ä¸ºloadingå›¾ç‰‡ï¼ŒçœŸå®å›¾ç‰‡æ”¾åœ¨data-src
          var ds = img.getAttribute('data-src')
          //åˆ›å»ºimageå¯¹è±¡ï¼Œç”¨äºè·å–å›¾ç‰‡å®½é«˜
          var imgtemp = new Image()
          //åˆ¤æ–­æ˜¯å¦å­˜åœ¨data-src
          if (ds != null && ds.length > 0) {
            imgtemp.src = ds
          } else {
            imgtemp.src = img.src
          }
          //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¼“å­˜
          if (imgtemp.complete) {
            var imgobj = {
              src: imgtemp.src,
              w: imgtemp.width,
              h: imgtemp.height,
            }
            imgitems[i] = imgobj
            addImgClick(img, i)
          } else {
            console.log('è¿›æ¥äº†2')
            imgtemp.index = i
            imgtemp.img = img
            imgtemp.onload = function () {
              var imgobj = {
                src: this.src,
                w: this.width,
                h: this.height,
              }
              //ä¸è¦ä½¿ç”¨pushï¼Œå› ä¸ºonloadå‰åé¡ºåºä¼šä¸åŒ
              imgitems[this.index] = imgobj
              //æ·»åŠ ç‚¹å‡»äº‹ä»¶
              addImgClick(this.img, this.index)
            }
          }
        }
      }
      //åˆå§‹åŒ–
      initImg()
    </script>
     <script type="application/javascript" src="https://unpkg.com/valine"></script>
<script type="application/javascript">
  new Valine({
    el: '#vlaine-comment',
    appId: 'AxKJfVBXhXXWlO1ABZHQtcDx-MdYXbMMI',
    appKey: 'BMP1hITDOIUE3osQxLR6EWXC',
    pageSize: '10',
    notify: 'true',
    avatar: 'mp',
    verify: 'true',
    placeholder: 'æ¥éƒ½æ¥äº†ï¼Œä¸å¦¨è¯„è®ºä¸€ä¸‹',
    visitor: 'true',
    highlight: 'true',
    recordIP: 'true',
  })
</script>
  
  </body>
</html>
